(()=>{var E=Object.create;var v=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var O=Object.getOwnPropertyNames;var P=Object.getPrototypeOf,I=Object.prototype.hasOwnProperty;var x=(a,e)=>()=>(e||a((e={exports:{}}).exports,e),e.exports);var N=(a,e,s,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of O(e))!I.call(a,i)&&i!==s&&v(a,i,{get:()=>e[i],enumerable:!(t=A(e,i))||t.enumerable});return a};var U=(a,e,s)=>(s=a!=null?E(P(a)):{},N(e||!a||!a.__esModule?v(s,"default",{value:a,enumerable:!0}):s,a));var w=x((L,C)=>{"use strict";function $({mustBeMetaMask:a=!1,silent:e=!1,timeout:s=3e3}={}){i();let t=!1;return new Promise(n=>{window.ethereum?r():(window.addEventListener("ethereum#initialized",r,{once:!0}),setTimeout(()=>{r()},s));function r(){if(t)return;t=!0,window.removeEventListener("ethereum#initialized",r);let{ethereum:c}=window;c&&(!a||c.isMetaMask)?n(c):(!e&&console.error("@metamask/detect-provider:",a&&c?"Non-MetaMask window.ethereum detected.":"Unable to detect window.ethereum."),n(null))}});function i(){if(typeof a!="boolean")throw new Error("@metamask/detect-provider: Expected option 'mustBeMetaMask' to be a boolean.");if(typeof e!="boolean")throw new Error("@metamask/detect-provider: Expected option 'silent' to be a boolean.");if(typeof s!="number")throw new Error("@metamask/detect-provider: Expected option 'timeout' to be a number.")}}C.exports=$});var k=U(w(),1);var B=function(a){let e=arguments,s=this,t,i,n=1,r="",c="",o=[0],l=h=>{n===1&&(h||(r=r.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?o.push(h?e[h]:r):n===3&&(h||r)?(o[1]=h?e[h]:r,n=2):n===2&&r==="..."&&h?o[2]=Object.assign(o[2]||{},e[h]):n===2&&r&&!h?(o[2]=o[2]||{})[r]=!0:n>=5&&(n===5?((o[2]=o[2]||{})[i]=h?r?r+e[h]:e[h]:r,n=6):(h||r)&&(o[2][i]+=h?r+e[h]:r)),r=""};for(let h=0;h<a.length;h++){h&&(n===1&&l(),l(h));for(let d=0;d<a[h].length;d++)t=a[h][d],n===1?t==="<"?(l(),o=[o,"",null],n=3):r+=t:n===4?r==="--"&&t===">"?(n=1,r=""):r=t+r[0]:c?t===c?c="":r+=t:t==='"'||t==="'"?c=t:t===">"?(l(),n=1):n&&(t==="="?(n=5,i=r,r=""):t==="/"&&(n<5||a[h][d+1]===">")?(l(),n===3&&(o=o[0]),n=o,(o=o[0]).push(s.apply(null,n.slice(1))),n=0):t===" "||t==="	"||t===`
`||t==="\r"?(l(),n=2):r+=t),n===3&&r==="!--"&&(n=4,o=o[0])}return l(),o.length>2?o.slice(1):o[1]},u=B.bind((a,e,...s)=>{let t=null,i=!1;["svg","use","symbol","path","g","defs","title"].indexOf(a)>-1?(t=document.createElementNS("http://www.w3.org/2000/svg",a),i=!0):t=document.createElement(a);for(let n in e)if(n.slice(0,2)==="on"){let r=n.slice(2),c=e[n];if(c==null)continue;t.addEventListener(r,c)}else if(["disabled","selected","checked"].indexOf(n)>-1)e[n]&&t.setAttribute(n,n);else if(n==="xlinkHref"&&i)e[n]&&t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e[n]);else if(n==="href"&&i)e[n]&&t.setAttributeNS("http://www.w3.org/1999/xlink","href",e[n]);else{if(e[n]==null)continue;t.setAttribute(n,e[n])}return s.length===0?t:(s.flat(1).forEach(n=>{n instanceof Node?t.appendChild(n):t.appendChild(document.createTextNode(n))}),a==null?t.children:t)});function p(a,e){for(;e.firstChild;)e.removeChild(e.firstChild);Array.isArray(a)?a.forEach(s=>e.appendChild(s)):e.appendChild(a)}function b(a){return a.replace(/([A-Z])/g,"-$1").toLowerCase()}function m(a){return(typeof a=="object"||typeof a=="function")&&typeof a.then=="function"}function _(a,e){let s=function(t){if(!t)return[];let i=[];return Object.keys(t).forEach(n=>{(t[n].observed==null||t[n].observed)&&i.push(b(n))}),i}(e.props);globalThis.customElements.get(a)||globalThis.customElements.define(a,class extends globalThis.HTMLElement{static get observedAttributes(){return s}get componentTagName(){return a}connectedCallback(){this.connectedCallbackCount==null&&(this.connectedCallbackCount=0),this.connectedCallbackCount=this.connectedCallbackCount+1,this._checkInit(),this._preprocess()}disconnectedCallback(){typeof this.removed=="function"&&(this.removed(),this.isRemovedCalled=!0)}attributeChangedCallback(){this.connectedCallbackCount!=null&&(this._checkInit(),this._preprocess())}get initialised(){return this._props&&this._state&&this._computed&&this.templateRenderer}_checkInit(){this.initialised||this._init(e)}_init(t){if(this._props=t.props||{},this._computed=t.computed||{},t.state&&typeof t.state!="function")throw new Error("State must be a function!");this._state=t.state||{},this.computedCache={},this.status="render",this.connectedCallbackCount=0,this.props=this._processProps(),typeof this._state=="function"&&(this._state=this._state.bind(this)()),this.state=this._monitorState(this._state),this.root=this._processRoot(t.root),this.slots=this._processSlots(),this.render=t.render||null,this.templateRenderer=t.renderer,this.template=null,this.created=t.created||null,this.mounted=t.mounted||null,this.updated=t.updated||null,this.removed=t.removed||null,this.isCreatedCalled=!1,this.isMountedCalled=!1,this.isRemovedCalled=!1,this.emit=(i,n)=>{(function(r,c,o={}){let l=Object.assign({},{bubbles:!0,cancelable:!0,composed:!1},o),h;"composed"in CustomEvent.prototype?h=new CustomEvent(c,l):(h=document.createEvent("CustomEvent"),h.initCustomEvent(c,l.bubbles,l.cancelable,l.detail),Object.defineProperty(h,"composed",{value:l.composed})),r.dispatchEvent(h)})(this,i,{detail:n})},this.setState=(i,n)=>{let r=o=>{if(!o||typeof o!="object")return;let l=this.updated;n&&(this.updated=()=>{setTimeout(n),this.updated=l||void 0}),this.status="transaction";for(let h in o)this.state[h]&&this.state[h]===o[h]||(this.state[h]=o[h]);this.status="render",this._processRender()},c=i(this.state);m(c)?c.then(r):r(c)},this._processMethodsAndComputedProps(t),this._processInstanceProps(this._props),typeof this.created!="function"||this.isCreatedCalled||(this.created(),this.isCreatedCalled=!0)}_processProps(){let t={};return Object.keys(this._props).forEach(i=>{let n={},r=this._props[i],c=this._getAttribute(i),o=null;if(r.default!=null&&(o=r.default),r.required&&c==null)o!=null?(console.info(`No biggie, the required prop '${i}' has no value set, so the default has been set`),n[i]=o):(n[i]=null,console.error(`The required prop '${i}' has no value set`));else switch(r.type){case String:default:n[i]=c||o;break;case Number:n[i]=c!=null?parseFloat(c):o??0;break;case Boolean:n[i]=c!=null?c.toString()==="true":o!=null&&o;break;case Object:try{n[i]=c!=null?JSON.parse(c):o??void 0}catch(l){n[i]=o??void 0,console.error("An object parse issue occurred",l)}}t[i]=n[i],this._instanceProps&&this._instanceProps[i]&&(t[i]=this._instanceProps[i])}),t}_processMethodsAndComputedProps(t){let i=this,n=Object.keys(t);n.length&&n.forEach(r=>{i[r]||typeof t[r]!="function"||(i[r]=t[r].bind(i)),r==="computed"&&this._processComputed(t[r])})}_processRoot(t){switch(t){case"standard":default:return this;case"shadow":return this.attachShadow({mode:"open"});case"shadow:closed":return this.attachShadow({mode:"closed"})}}_processComputed(t){let i=this,n=Object.keys(t);n.length&&n.forEach(r=>{i[r]?console.warn(`Computed property '${r}' already exists on the component instance`):Object.defineProperty(i,r,{get:()=>(i.computedCache[r]||(i.computedCache[r]=t[r].bind(i)()),i.computedCache[r])})})}_processRender(){let t=this.render?this.render():void 0;t&&(this.template=t,this._updateRender())}_monitorState(t){let i=this;return new Proxy(t,{set:(n,r,c)=>(n[r]===c||(n[r]=c,i.computedCache={},i.status==="render"&&i._processRender()),!0)})}_processSlots(){let t=this.childNodes,i={default:[]};return t.length>0&&[...t].forEach(n=>{let r=n.getAttribute?n.getAttribute("slot"):null;r?i[r]=n:i.default.push(n)}),i}_getAttribute(t){try{return this.getAttribute(b(t))}catch(i){return console.error("A get prop error occurred",i),""}}_processInstanceProps(t){let i=this,n=Object.keys(t);t&&n.forEach(r=>{let c;i[r]&&(c=i[r],delete i[r]),Object.defineProperty(i,r,{get(){return this._instanceProps&&this._instanceProps[r]?this._instanceProps[r]:this.getAttribute(b(r))},set(o){return this._instanceProps||(this._instanceProps={}),this._instanceProps[r]=o,this.setAttribute(b(r),typeof o=="object"?JSON.stringify(o):o.toString()),!0},enumerable:!0}),c&&(i[r]=c)})}_preprocess(){this.computedCache={},this.props=this._processProps(),this._processRender()}_updateRender(){this.template&&(m(this.template)?this.template.then(t=>{this.templateRenderer(t,this.root),this._callLifecycleMethods()}).catch(t=>console.error("A component render error occurred",t)):(this.templateRenderer(this.template,this.root),this._callLifecycleMethods()))}_callLifecycleMethods(){typeof this.mounted!="function"||this.isMountedCalled||this.mounted(),this.isMountedCalled=!0,typeof this.updated=="function"&&this.isMountedCalled&&this.updated()}})}function f(a,e){return{...e,created(){this.subscribeCallback=()=>{this.computedCache={},this._processRender()},this.setStore(a),e.created&&e.created.call(this)},mounted(){this._subscribeToStores(!1),e.mounted&&e.mounted.call(this)},updated(){this._subscribeToStores(!1),e.updated&&e.updated.call(this)},removed(){this._unsubscribeFromStores(),e.removed&&e.removed.call(this)},setStore(s){this.store=s,this._subscribeToStores()},_subscribeToStores(s=!0){this.store&&this.store.subscribe&&typeof this.store.subscribe=="function"&&!this.unsubscribe?(this.unsubscribe=this.store.subscribe(this.subscribeCallback),s&&this.subscribeCallback()):this.store&&typeof this.store=="object"&&!this.store.subscribe&&(this.unsubscribe={},Object.keys(this.store).forEach(t=>{this.store[t]&&this.store[t].subscribe&&typeof this.store[t].subscribe=="function"&&!this.unsubscribe[t]&&(this.unsubscribe[t]=this.store[t].subscribe(this.subscribeCallback))}),s&&this.subscribeCallback())},_unsubscribeFromStores(){this.store&&this.unsubscribe&&typeof this.unsubscribe=="object"?(Object.keys(this.unsubscribe).forEach(s=>{this.unsubscribe[s]()}),this.unsubscribe=null):this.store&&this.unsubscribe&&typeof this.unsubscribe=="function"&&(this.unsubscribe(),this.unsubscribe=null)}}}var g=class{constructor(e,s){this.namespace=e,this.storage=s}setState(e){e?(this.storage.setItem(`${this.namespace}:state`,typeof e=="string"?e:JSON.stringify(e)),this.storage.setItem(`${this.namespace}:lastUpdated`,new Date().getTime().toString())):this.removeState()}getState(){let e=this.storage.getItem(`${this.namespace}:state`);return e?JSON.parse(e):void 0}lastUpdated(){let e=this.storage.getItem(`${this.namespace}:lastUpdated`);return e?parseInt(e,10):void 0}removeState(){this.storage.removeItem(`${this.namespace}:state`),this.storage.removeItem(`${this.namespace}:lastUpdated`)}};function R(a,e="session"){return new g(a,e==="local"?globalThis.localStorage:globalThis.sessionStorage)}var y=class{constructor(e){let s=this;s.state={},s.getterCache={},s.status="resting",s.transaction=!1,s.transactionCache={},s.callbacks=[],this._processActions(e);let t=e.initialState||{};if(s.copyOfInitialState=s._copyValue(t),s.ttl=-1,s.lastUpdatedState={},e.ttl&&(s.ttl=e.ttl,Object.keys(s.copyOfInitialState).forEach(i=>s.lastUpdatedState[i]=new Date().getTime())),e.persist){s.persist=typeof e.persist=="string"?R(e.persist):e.persist;let i=s.persist.getState(),n=s.persist.lastUpdated();i&&n&&(s.ttl===-1||s._lastUpdatedTimeDiff(n)<s.ttl)&&(t=i)}this._processState(t)}_processActions(e){let s=this,t=Object.keys(e);t.length&&t.forEach(i=>{s[i]||typeof e[i]!="function"||(s[i]=e[i].bind(s))})}_processState(e){let s=this;s.state=new Proxy(e,{set:(t,i,n)=>(s.transaction&&!s.transactionCache[i]&&(s.transactionCache[i]=s._copyValue(t[i])),t[i]=n,s.lastUpdatedState[i]=new Date().getTime(),s.getterCache={},s.transaction||(s.persist&&s.persist.setState(s.state),s.status="resting",s._processCallbacks(s.state)),!0),get:(t,i)=>s.ttl>-1&&s._lastUpdatedTimeDiff(s.lastUpdatedState[i])>s.ttl?(s.persist&&s.persist.removeState(),s.copyOfInitialState[i]):t[i]})}_lastUpdatedTimeDiff(e){return Math.round((new Date().getTime()-e)/1e3)}setState(e){let s=i=>{if(!i||typeof i!="object")return;let n=this.transaction;n||(this.transactionCache={},this.transaction=!0);for(let r in i)this.state[r]&&this.state[r]===i[r]||(this.state[r]=i[r]);n||(this.transaction=!1,this.persist&&this.persist.setState(this.state),this._processCallbacks(this.state))},t=e(this.state);m(t)?t.then(s):s(t)}getState(e){if(e){if(!this.getterCache[e]){let s=(Array.isArray(e)?e:e.match(/([^[.\]])+/g)).reduce((t,i)=>t&&t[i],this.state);if(s==null)return;this.getterCache[e]=s}return this.getterCache[e]}}_processCallbacks(e){return!!this.callbacks.length&&(this.callbacks.forEach(s=>s(e)),!0)}subscribe(e){if(typeof e!="function")throw new Error("Dude, you can only subscribe to store changes with a valid function");return this.callbacks.push(e),()=>{this.callbacks=this.callbacks.filter(s=>s!==e)}}_copyValue(e){return e&&JSON.parse(JSON.stringify(e))}clear(e=!0){this.getterCache={},this.transactionCache={},this.lastUpdatedState={},this.persist&&this.persist.removeState(),this.transaction=!0,this.status="clear";let s=this._copyValue(this.copyOfInitialState);for(let t in s)this.state[t]=s[t];this.transaction=!1,this.status="resting",e&&this._processCallbacks(this.state)}};function T(a,e){let s=D(a);return s||(s=new y(e),globalThis.__ficusjs__=globalThis.__ficusjs__||{},globalThis.__ficusjs__.store=globalThis.__ficusjs__.store||{},globalThis.__ficusjs__.store[a]=s,s)}function D(a){if(globalThis.__ficusjs__&&globalThis.__ficusjs__.store&&globalThis.__ficusjs__.store[a])return globalThis.__ficusjs__.store[a]}var S=T("web3.sign",{initialState:{account:null,signature:null,web3:{provider:null}},setAccount(a){this.state.account=a},setSignature(a){this.state.signature=a}});_("web3-connect-metamask",f(S,{renderer:p,async handleConnect(){let a=await j(),e=await M(a);this.store.setAccount(e),console.info(`Account connected: ${e}`)},render(){return u`
        <button type="button" onclick=${this.handleConnect}>
          Connect Wallet
        </button>
      `}}));_("web3-sign-button",f(S,{renderer:p,props:{message:{type:String,required:!0}},async handleSign(){let{message:a}=this.props,{account:e}=this.store.state,s=await j(),t=await V(s,e,a);this.store.setSignature(t)},render(){return u`
        <button type="button" onclick=${this.handleSign}>Sign</button>
      `}}));_("web3-sign-msg",f(S,{renderer:p,props:{message:{type:String,required:!0}},render(){let{account:a,signature:e}=this.store.state,{message:s}=this.props;return u`
        <div>
          <p>Message: ${s}</p>
          <p>Signature: ${e}</p>
          ${a?"":u`<web3-connect-metamask><//>`}
          ${a?u`<web3-sign-button message=${s}><//>`:""}
        </div>
      `}}));async function j(){return await(0,k.default)()}async function M(a){if(a)return(await ethereum.request({method:"eth_requestAccounts"}))[0];window.alert("Only works with Metamask")}async function V(a,e,s){return new Promise((t,i)=>{a.sendAsync({method:"personal_sign",params:[s,e],from:e},function(n,r){n&&i(n),t(r.result.substring(2))})})}})();
//# sourceMappingURL=web3-input.js.map
